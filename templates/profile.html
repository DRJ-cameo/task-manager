<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>User Profile - Task Manager</title>

  <style>
    :root {
      --bg1:#6a11cb;
      --bg2:#2575fc;
      --card: rgba(255,255,255,0.08);
      --muted: rgba(255,255,255,0.9);
      --panel-shadow: 0 10px 30px rgba(0,0,0,0.18);
      --radius: 14px;
    }

    body {
      margin: 0;
      font-family: "Poppins", sans-serif;
      background: linear-gradient(135deg,var(--bg1),var(--bg2));
      min-height: 100vh;
      color: white;
      background-size: 400% 400%;
      animation: floatingBg 18s infinite alternate linear;
      -webkit-font-smoothing:antialiased;
    }

    @keyframes floatingBg {
      from { background-position: 0 0; }
      to { background-position: 100% 100%; }
    }

    /* NAVBAR */
    .navbar{
      display:flex; align-items:center; justify-content:space-between;
      padding:12px 16px; background: rgba(0,0,0,0.18); backdrop-filter: blur(6px);
      position:relative; z-index:1000;
    }
    .navbar-left{
      display:flex; align-items:center; gap:12px; min-width:0;
    }
    .brand-logo {
      width:40px; height:40px; border-radius:8px; object-fit:cover; box-shadow:0 6px 14px rgba(0,0,0,0.28);
      flex:0 0 auto;
    }
    .brand-text {
      font-weight:700; font-size:1.05rem; color:#fff; white-space:nowrap;
      overflow:hidden; text-overflow:ellipsis; flex:1 1 auto; min-width:0;
    }

    .navbar-right {
      display:flex; align-items:center; gap:12px; flex:0 0 auto;
    }

    .menu-icon{
      display:flex; flex-direction:column; gap:6px; cursor:pointer; padding:8px;
      background: rgba(255,255,255,0.92);
      border-radius:10px; box-shadow: 0 6px 18px rgba(0,0,0,0.25);
      -webkit-tap-highlight-color: transparent;
      z-index:1300;
    }
    .menu-icon div { width:28px; height:3.6px; background:rgba(10,14,20,0.96); border-radius:3px; }

    .menu{
      position:absolute; right:16px; top:calc(100% + 12px);
      width:220px;
      background: linear-gradient(180deg, rgba(6,10,30,0.98), rgba(10,16,40,0.98));
      border-radius:12px; padding:8px;
      box-shadow:0 16px 40px rgba(6,12,40,0.24);
      transform-origin: top right;
      transform: translateY(-6px) scale(.98);
      opacity:0; pointer-events:none;
      transition: opacity .22s ease, transform .22s cubic-bezier(.2,9,2,1);
      z-index:1200;
    }
    .menu.open { transform: translateY(0) scale(1); opacity:1; pointer-events:auto; display:flex; flex-direction:column; }
    .menu a{ color:rgba(255,255,255,0.92); text-decoration:none; padding:10px 12px; font-weight:600; border-radius:8px; margin:4px 0; }
    .menu a:hover{ background: rgba(255,255,255,0.03); transform:translateX(4px); transition: transform .12s, background .12s; }

    /* container and header */
    .container {
      width:92%;
      max-width:820px;
      margin:34px auto;
    }
    header { padding-left: 6px; } /* slight left offset so header is not flush to edge */
    header h1 { margin:0; font-size:2.6rem; font-weight:800; line-height:1; }
    header p { margin:12px 0 0; color: rgba(255,255,255,0.92); font-weight:600; }

    /* profile card */
    .profile-card {
      background:var(--card);
      padding:22px;
      border-radius:var(--radius);
      box-shadow:var(--panel-shadow);
      animation: fadeInUp .6s ease;
      margin-top:18px;
      overflow:hidden;
    }
    @keyframes fadeInUp {
      from {opacity:0; transform:translateY(12px);}
      to {opacity:1; transform:translateY(0);}
    }

    /* layout inside card - allow wrapping on small screens */
    .card-row {
      display:flex; gap:16px; align-items:flex-start; min-width:0;
      flex-wrap:wrap; /* <-- important: let avatar drop above text on narrow screens */
    }

    .avatar-wrap {
      width:84px; height:84px; border-radius:50%; overflow:hidden; flex:0 0 84px;
      display:flex; align-items:center; justify-content:center; background:linear-gradient(135deg, rgba(255,255,255,0.08), rgba(255,255,255,0.02));
    }
    /* avatar image: true circle and preserve aspect ratio (fix distortion) */
    .profile-avatar {
      width:100%; height:100%; border-radius:50%; object-fit:cover; display:block;
    }

    .card-main { flex:1 1 auto; min-width:0; } /* min-width:0 important for mobile flex shrinking */

    /* Name row: label + value flexible so value can wrap/ellipsis if needed */
    .name-row {
      display:flex; align-items:center; gap:10px; flex-wrap:wrap; /* allow wrapping for very narrow screens */
      margin-bottom:8px;
    }
    .name-row .icon { font-size:1.1rem; flex:0 0 auto; }
    .name-row .label { opacity:0.95; font-weight:700; flex:0 0 auto; }
    .name-row .value { font-weight:700; flex:1 1 auto; min-width:0; /* allow shrink */ overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }

    /* Email & meta rows: use flexible label/value pair so long email wraps fallback-friendly */
    .profile-meta {
      display:flex; align-items:center; gap:8px; color: rgba(255,255,255,0.95); margin-top:8px;
      width:100%; min-width:0;
    }
    .profile-meta .meta-icon { flex:0 0 auto; }
    .profile-meta .meta-label { opacity:0.95; margin-left:0; flex:0 0 auto; }
    .profile-meta .meta-value { overflow:hidden; text-overflow:ellipsis; white-space:nowrap; flex:1 1 auto; min-width:0; }

    /* When there is not enough space, allow the value to wrap to next line */
    .profile-meta.wrap-value .meta-value { white-space:normal; }

    /* edit button */
    .btn {
      background:#00b894; padding:10px 18px; border-radius:10px; border:none; margin-top:18px; color:white; font-weight:700; cursor:pointer;
    }

    footer { text-align:center; margin-top:40px; padding:20px; opacity:0.9; font-size:0.95rem; color: rgba(255,255,255,0.92); }

    /* Responsive tweaks */
    @media (max-width:720px) {
      header h1 { font-size:2.2rem; }
    }
    @media (max-width:480px) {
      .container { width:94%; margin:28px auto; }
      .brand-text { font-size:0.96rem; }
      .profile-avatar, .avatar-wrap { width:72px; height:72px; flex:0 0 72px; }
      .name-row .value { max-width: calc(100% - 36px); }
      /* on very small screens, allow meta values to wrap so they do not overflow the card */
      .profile-meta { gap:6px; }
      .profile-meta .meta-value { white-space:normal; } /* allow wrapping of email */
      .name-row .value { white-space:normal; }
    }


    /* hamburger -> X animation (add this near your .menu-icon CSS) */
.menu-icon div {
  width:28px;
  height:3.6px;
  background: rgba(10,14,20,0.96);
  border-radius:3px;
  transition: transform .18s ease, opacity .12s ease;
  transform-origin: center;
}

/* when open: first and third bars rotate & move, middle bar fades */
.menu-icon.open > div:nth-child(1) {
  transform: translateY(6px) rotate(45deg);
}
.menu-icon.open > div:nth-child(2) {
  transform: scaleX(0);
  opacity: 0;
}
.menu-icon.open > div:nth-child(3) {
  transform: translateY(-6px) rotate(-45deg);
}

/* slightly larger clickable area on mobile and keep it above other elements */
.menu-icon {
  -webkit-tap-highlight-color: transparent;
  touch-action: manipulation;
  user-select: none;
}

  </style>
</head>

<body>
  <!-- NAVBAR -->
  <div class="navbar" role="navigation" aria-label="Main navigation">
    <div class="navbar-left">
      <img src="/static/images/logo.png" alt="Task Manager logo" class="brand-logo" />
      <div class="brand-text">Task Manager</div>
    </div>

    <div class="navbar-right">
      <div id="menuIcon" class="menu-icon" aria-label="menu" title="menu">
        <div></div><div></div><div></div>
      </div>
      <nav id="menu" class="menu" aria-hidden="true">
        <a href="/dashboard">Home</a>
        <a href="/mytask">My Tasks</a>
        <a href="/profile">Profile</a>
        <a href="/about">About</a>
        <a href="/logout" style="color:#ff6b6b;">Logout</a>
      </nav>
    </div>
  </div>

  <div class="container">
    <header>
      <h1>Your Profile</h1>
      <p>Manage your account details</p>
    </header>

    <div class="profile-card" role="region" aria-label="Profile card">
      <div class="card-row">
        <div class="avatar-wrap">
          {% if avatar %}
            <img src="{{ url_for('static', filename='uploads/avatars/' + avatar) }}" alt="Profile picture" class="profile-avatar" />
          {% else %}
            <div style="font-weight:800; color:#fff">{{ (fullname[:1] if fullname) or 'U' }}</div>
          {% endif %}
        </div>

        <div class="card-main">
          <div class="name-row" aria-label="Full name">
            <span class="icon">ðŸ‘¤</span>
            <span class="label">Name:</span>
            <span class="value" title="{{ fullname or 'Not provided' }}">{{ fullname or 'Not provided' }}</span>
          </div>

          <div class="profile-meta" aria-label="Email">
            <span class="meta-icon">ðŸ“§</span>
            <span class="meta-label">Email:</span>
            <span class="meta-value" title="{{ email or 'Not provided' }}">{{ email or 'Not provided' }}</span>
          </div>

          <div class="profile-meta" aria-label="Member since">
            <span class="meta-icon">ðŸ—“</span>
            <span class="meta-label">Member since:</span>
            <span class="meta-value" title="{{ join_date or 'Not available' }}">{{ join_date or 'Not available' }}</span>
          </div>

          <button class="btn" onclick="location.href='/edit_profile'">Edit Profile</button>
        </div>
      </div>
    </div>

    <footer>Â© 2025 Task Manager</footer>
  </div>

<script>
  /* MENU open/close */
  const menu = document.getElementById('menu'),
        menuIcon = document.getElementById('menuIcon');

  function openMenu(){
    menu.classList.add('open');
    menuIcon.classList.add('open');
    menu.setAttribute('aria-hidden','false');
  }
  function closeMenu(){
    menu.classList.remove('open');
    menuIcon.classList.remove('open');
    menu.setAttribute('aria-hidden','true');
  }
  menuIcon.addEventListener('click', e => {
    e.stopPropagation();
    if(menu.classList.contains('open')) closeMenu(); else openMenu();
  });
  document.addEventListener('click', (e)=>{ if(!menu.contains(e.target) && !menuIcon.contains(e.target)) closeMenu(); });
  document.addEventListener('keydown', (e)=>{ if(e.key === 'Escape') closeMenu(); });
  document.querySelectorAll('#menu a').forEach(a => a.addEventListener('click', ()=> closeMenu()));

  /* Workaround for some mobile browsers which delay layout of top chrome. This forces a small repaint/reflow on load. */
  window.addEventListener('load', () => {
    setTimeout(()=> {
      document.documentElement.style.transform = 'translateZ(0)';
      window.dispatchEvent(new Event('resize'));
      setTimeout(()=> document.documentElement.style.transform = '', 60);
    }, 120);
  });
</script>

</body>
</html>
